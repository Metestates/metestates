(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(3494)}])},3494:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return D}});var r=t(603),a=t(5893),i=t(7294),c=t(9653),o=t(7829),s=t(8641),l=t(7295),d={ParcelPixelWidth:16,ParcelPixelMinWidth:4,ParcelPixelMaxWidth:80,ParcelBlockWidth:30,ParcelsPerQuery:900,Origin:{x:-0,y:0},PanningStep:1},u=function(){var e=(0,r.Z)(i.useState({width:window.innerWidth,height:window.innerHeight}),2),n=e[0],t=e[1];return i.useEffect((function(){var e=function(){t({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[]),n},f=function(){var e=(0,r.Z)(i.useState({x:0,y:0}),2),n=e[0],t=e[1];return i.useEffect((function(){var e=function(e){t({x:e.clientX,y:e.clientY})};return window.addEventListener("mousemove",e),function(){window.removeEventListener("mousemove",e)}}),[]),n};function h(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1/0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;return Math.max(n||-1/0,Math.min(e,t||1/0))}var v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{delta:1},t=(0,r.Z)(i.useState(e),2),a=t[0],c=t[1];return i.useEffect((function(){var e=function(e){var t=h(a+(e.deltaY<0?-1*n.delta:n.delta),n.minValue,n.maxValue);c(t)};return window.addEventListener("wheel",e),function(){window.removeEventListener("wheel",e)}}),[n.delta,n.maxValue,n.minValue,a,c]),a};var x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0},n=(0,r.Z)(i.useState(e),2),t=n[0],a=n[1];return i.useEffect((function(){var e=function(e){var n=d.PanningStep,r={x:0,y:0};switch(e.key){case"ArrowUp":r.y=n;break;case"ArrowDown":r.y=-n;break;case"ArrowLeft":r.x=-n;break;case"ArrowRight":r.x=n}a({x:t.x+r.x,y:t.y+r.y})};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}),[t,a]),t},w=t(5553),p=t(4111),g=t.n(p),k=t(4146),y=t(4627),m=t(9345),j=function(e,n){var t;if(t=(0,y.W)(n&&{contract:new k.CH(e,m.Qv),method:"balanceOf",args:[n]}),!n)return[void 0,void 0,!0];if(!t)return[void 0,void 0,!1];var r=t.value,a=t.error;return a?[void 0,a,!1]:[r.balance,void 0,!1]},B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(e.length<11)return e;var n=[e.slice(0,5),e.slice(-4)],t=n[0],r=n[1];return"".concat(t,"\u2026").concat(r)},_=t(2850),P=t.n(_),T=function(e){var n=e.token,t=e.address,i=(0,r.Z)(j(n.address,t),3),c=i[0],o=i[1];if(i[2]||!c&&!o)return(0,a.jsx)("div",{children:(0,a.jsx)("p",{children:"Loading\u2026"})});if(o)return(0,a.jsx)("div",{children:(0,a.jsxs)("p",{children:["Error retreiving token balance: ",o]})});var s=(0,w.formatUnits)(c,n.decimals);return(0,a.jsx)("div",{className:P().TokenBalance,children:(0,a.jsxs)("div",{className:P().TokenBalanceWrapper,children:[(0,a.jsx)("div",{className:P().TokenBalanceLeft,children:(0,a.jsx)("div",{className:P().TokenBalanceJazziconWrapper,children:(0,a.jsx)(g(),{diameter:40,seed:(0,p.jsNumberForAddress)(t)})})}),(0,a.jsxs)("div",{className:P().TokenBalanceRight,children:[(0,a.jsx)("span",{className:P().TokenBalanceSpan,children:B(t)}),c&&(0,a.jsxs)("span",{className:P().TokenBalanceSpan,children:[s," ",n.symbol]})]})]})})},b=t(6977),E=t(7741),W=t(6048),C=t.n(W),N=function(){var e=(0,l.K)().activateBrowserWallet,n=(0,b.z)().notifications,t=i.useCallback((function(){e().then((function(){console.log("Connected to a new browser wallet\u2026")}))}),[e]);return i.useEffect((function(){n.map((function(e){if("walletConnected"===e.type){var n=e.address;console.log("Connected to wallet with address ".concat(n,"."))}else console.log(e)}))}),[n]),(0,a.jsx)(E.zx,{className:C().ConnectToWalletButton,colorScheme:"green",onClick:t,children:"Connect Wallet"})},S=t(6252),L=t(8872),z=t(7297);function M(){var e=(0,z.Z)(["\n\tquery GET_PARCEL_BLOCK(\n\t\t$first: Int,\n\t\t$xGte: BigInt\n\t\t$xLt: BigInt\n\t\t$yLte: BigInt\n\t\t$yGt: BigInt\n\t) {\n\t\tparcels(\n\t\t\tfirst: $first,\n\t\t\twhere: { x_gte: $xGte, x_lt: $xLt, y_lte: $yLte, y_gt: $yGt }\n\t\t) {\n\t\t\tid\n\t\t\ttokenId\n\t\t\towner {\n\t\t\t\taddress\n\t\t\t}\n\t\t\tx\n\t\t\ty\n\t\t\tdata {\n\t\t\t\tname\n\t\t\t\tdescription\n\t\t\t\tipns\n\t\t\t}\n\t\t\testate {\n\t\t\t\tid\n\t\t\t\ttokenId\n\t\t\t\towner {\n\t\t\t\t\taddress\n\t\t\t\t}\n\t\t\t\t# parcels\n\t\t\t}\n\t\t}\n\t}\n"]);return M=function(){return e},e}var R=(0,t(7283).Ps)(M());function I(e,n){return{x:e-e%d.ParcelBlockWidth,y:n-n%d.ParcelBlockWidth}}function O(e,n,t){return null===e||void 0===e?void 0:e.parcels.find((function(e){return parseInt(e.x)===n&&parseInt(e.y)===t}))}var G=function(e,n,t,r){var a=I(e,n);window.getBlockCoordinate=I;var i,c={first:d.ParcelsPerQuery,xGte:a.x,xLt:a.x+d.ParcelBlockWidth,yLte:a.y,yGt:a.y-d.ParcelBlockWidth},o="".concat(a.x,",").concat(a.y);return o in r?i=r[o]:(i=t.query({query:R,errorPolicy:"all",variables:c}),r[o]=i),i},Z=function(e){var n=e.size,t=e.origin,c=e.parcelSize,o=e.selectedParcel,s=e.setSelectedParcel,l=i.useRef(null),d=i.useRef(t),u=i.useRef(c),f=i.useRef(o),h=i.useRef(s);i.useEffect((function(){d.current=t}),[t]),i.useEffect((function(){u.current=c}),[c]),i.useEffect((function(){f.current=o}),[o]),i.useEffect((function(){h.current=s}),[s]);var v=(0,r.Z)(i.useState(null),2),x=v[0],w=v[1],p=(0,S.x)(),g=i.useMemo((function(){return{}}),[]),k=i.useCallback((function(){var e=function(e){for(var n=function(n){var t=n+d.current.x,a=d.current.y-e,i=d.current,c=u.current;G(t,a,p,g).then((function(o){var s=o.data,l=o.error,h=o.loading;if(JSON.stringify(i)===JSON.stringify(d.current)&&c===u.current){var v,w=[0,0,0,255];if(h)w=[248,248,255,.4];else if(l)w=[240,128,128,.4];else if(v=O(s||{parcels:[]},t,a)){var p=(0,r.Z)(function(e,n,t){return"0x9a6ebe7e2a7722f8200d0ffb63a1f6406a0d7dce"===t?[0,0,0,255]:(t=t.slice(2),[parseInt(t.slice(0,12),16)%256,parseInt(t.slice(12,24),16)%256,parseInt(t.slice(24,36),16)%256,255])}(0,f.current,function(e){return(e.estate?e.estate:e).owner.address}(v)),4),g=p[0],k=p[1],y=p[2],m=p[3];g/=256,k/=256,y/=256;var j=1-function(e,n){return n&&!1===function(e,n){var t;if(n.estate||e.estate){if(n.estate&&e.estate){if(n.estate.owner.address===e.estate.owner.address)return!0}else if(n.estate){if(n.estate.owner.address===e.owner.address)return!0}else if(n.owner.address===(null===(t=e.estate)||void 0===t?void 0:t.owner.address))return!0}else if(e.owner.address===n.owner.address)return!0;return!1}(e,n)?.05:1}(v,f.current),B=.3*g+.6*k+.1*y;w=[256*(g+j*(B-g)),256*(k+j*(B-k)),256*(y+j*(B-y)),m]}var _=u.current,P=n*_,T=e*_;x.fillStyle="rgba(".concat(w.join(","),")"),x.fillRect(P,T,_,_)}}))},t=0;t<s;t++)n(t)};if(null!==l.current&&null!==x){var t=l.current,a=t.width,i=t.height;x.clearRect(0,0,a,i);for(var o=Math.ceil(n.height/c),s=Math.ceil(n.width/c),h=0;h<o;h++)e(h)}}),[p,g,c,x,n]),y=i.useRef(k);i.useEffect((function(){y.current=k}),[k]);var m=i.useCallback((function(e){var n=e.pageX-e.currentTarget.offsetLeft,t=e.pageY-e.currentTarget.offsetTop,r=Math.floor(n/c),a=Math.floor(t/c),i=r+d.current.x,o=d.current.y-a,s=d.current,l=u.current;G(i,o,p,g).then((function(e){if(JSON.stringify(s)===JSON.stringify(d.current)&&l===u.current){var n=e.data,t=(e.error,e.loading,O(n||{parcels:[]},i,o));t?h.current(t):h.current(null),window.setTimeout((function(){y.current()}))}}))}),[p,g,c]);return i.useEffect((function(){var e,n=l.current;null===n?w(null):(e=n.getContext("2d",{desynchronized:!1,willReadFrequently:!1}),w(e))}),[w]),i.useEffect(k,[k,x,n,u.current,d.current]),(0,a.jsx)("nav",{className:"CanvasParcelGrid ".concat((0,L.iv)({position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:-1,backgroundColor:"black",width:"".concat(n.width,"px"),height:"".concat(n.height,"px"),"&:hover":{cursor:"pointer"}})),"data-testid":"CanvasParcelGrid",children:(0,a.jsx)("canvas",{ref:l,width:n.width,height:n.height,onMouseMove:function(e){return m(e)},className:(0,L.iv)({width:"".concat(n.width,"px"),height:"".concat(n.height,"px")})})})},$=t(7901),A=t.n($),J=function(e){var n,t,r,i,c,o,s,l=e.parcel;return(0,a.jsxs)("ul",{className:A().ParcelDetails,"data-testid":"ParcelDetails",children:[(0,a.jsxs)("li",{children:["Owner:",B(l.owner.address)]},"owner"),(0,a.jsxs)("li",{children:["Coordinate:",l.x,", ",l.y]},"coordinate"),l.estate&&(0,a.jsxs)("li",{children:["Estate:",l.estate.owner.address]},"estate"),(null===(n=l.data)||void 0===n?void 0:n.name)&&(0,a.jsxs)("li",{children:["Name:",null===(t=l.data)||void 0===t?void 0:t.name]},"name"),(null===(r=l.data)||void 0===r?void 0:r.description)&&(0,a.jsxs)("li",{children:["Description:",null===(i=l.data)||void 0===i?void 0:i.description]},"description"),(null===(c=l.data)||void 0===c?void 0:c.ipns)&&(0,a.jsxs)("li",{children:["IPNS:",(0,a.jsx)("a",{href:null===(o=l.data)||void 0===o?void 0:o.ipns,target:"_blank",rel:"noreferrer",children:null===(s=l.data)||void 0===s?void 0:s.ipns})]},"ipns")]})},V={name:"Decentraland",symbol:"MANA",address:"0x0f5d2fb29fb7d3cfee444a200298f468908cc942",decimals:18},D=function(){var e=(0,l.K)().account,n=u(),t=v(d.ParcelPixelWidth,{delta:1,minValue:d.ParcelPixelMinWidth,maxValue:d.ParcelPixelMaxWidth}),h=x(d.Origin),w=(0,r.Z)(i.useState(null),2),p=w[0],g=w[1],k=f(),y=(0,r.Z)((0,c.kt)(),2),m=y[0],j=y[1],_=i.useCallback((function(){m?j.off():j.on()}),[m,j]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("header",{"data-theme":"dark",children:[!e&&(0,a.jsx)(N,{}),e&&(0,a.jsx)(T,{token:V,address:e})]}),(0,a.jsx)("main",{children:(0,a.jsxs)(o.J2,{isOpen:m,children:[(0,a.jsx)(s.xu,{onClick:_,children:(0,a.jsx)(Z,{size:n,origin:h,parcelSize:t,selectedParcel:p,setSelectedParcel:g})}),(0,a.jsx)(o.tW,{children:(0,a.jsx)("button",{style:{position:"absolute",top:p?k.y+15:0,left:p?k.x-0:0,width:0,height:0,opacity:0},children:"Click Me"})}),p&&(0,a.jsxs)(o.yk,{children:[(0,a.jsx)(o.QH,{}),(0,a.jsx)(o.us,{}),(0,a.jsxs)(o.Yt,{children:["Parcel ",B(p.id.substring(7))]}),(0,a.jsx)(o.b,{children:(0,a.jsx)(J,{parcel:p})})]})]})})]})}},6048:function(e){e.exports={ConnectToWalletButton:"ConnectToWalletButton_ConnectToWalletButton__v1hPl"}},7901:function(){},2850:function(e){e.exports={TokenBalance:"TokenBalance_TokenBalance__PokCX",TokenBalanceWrapper:"TokenBalance_TokenBalanceWrapper__tweM1",TokenBalanceLeft:"TokenBalance_TokenBalanceLeft__Wfz6G",TokenBalanceRight:"TokenBalance_TokenBalanceRight__wk_6T",TokenBalanceSpan:"TokenBalance_TokenBalanceSpan__zo9uR",TokenBalanceJazziconWrapper:"TokenBalance_TokenBalanceJazziconWrapper__QVyO0"}},6601:function(){}},function(e){e.O(0,[774,26,518,888,179],(function(){return n=8312,e(e.s=n);var n}));var n=e.O();_N_E=n}]);
//# sourceMappingURL=index-36daf23fa52a6ea5.js.map