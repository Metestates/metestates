{"version":3,"sources":["config/app-config.ts","hooks/use-screen-dimensions.ts","hooks/use-mousewheel-scalable.ts","hooks/use-controlled-coordinate.ts","queries/getBlockData.ts","hooks/use-parcel-block.ts","hooks/use-parcel.ts","utils/parcel.ts","components/ParcelGridCell/ParcelGridCell.tsx","constants/DAOContractAddress.ts","components/ParcelGrid/ParcelGrid.tsx","components/App/App.tsx","reportWebVitals.ts","index.tsx"],"names":["AppConfig","ParcelPixelWidth","ParcelPixelMinWidth","ParcelPixelMaxWidth","ParcelBlockWidth","ParcelsPerQuery","Origin","x","y","PanningStep","useScreenDimensions","React","width","window","innerWidth","height","innerHeight","screenDimensions","setScreenDimensions","onWindowResize","addEventListener","removeEventListener","clamp","value","min","Infinity","max","Math","useMousewheelScalable","initialValue","options","delta","scalableValue","setScalableValue","onMouseWheel","event","clampedValue","deltaY","minValue","maxValue","useControlledCoordinate","coord","coordinate","setCoordiante","onKeydown","step","key","getBlockDataQuery","gql","useParcelBlock","blockCoords","variables","first","xGte","xLt","sqrt","yLte","yGt","useQuery","errorPolicy","blockData","data","isBlockDataLoading","loading","blockError","error","console","warn","JSON","stringify","useParcel","parcelX","parcelY","parcel","blockCoordinate","block","parcels","find","p","parseInt","findParcel","ParcelGridCellDefaultStyles","padding","fontSize","filter","transition","ParcelGridCell","address","columnIndex","rowIndex","style","xMin","yMax","addr","estate","owner","backgroundColor","selectedParcel","slice","parcelSaturation","hasSameOwner","getParcelSaturation","grayscaleFilterValue","onMouseEnter","setSelectedParcel","join","opacity","areEqual","buildItemData","memoize","size","ParcelGrid","parcelBounds","parcelCellSize","columnCount","ceil","rowCount","itemData","onMouseLeave","className","css","overflow","cursor","columnWidth","rowHeight","itemKey","App","origin","useState","color","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","getClient","a","cache","InMemoryCache","typePolicies","Parcel","keyFields","localForage","config","name","storeName","description","client","ApolloClient","uri","ReactDOM","render","StrictMode","ApolloProvider","document","getElementById","init"],"mappings":"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","file":"static/js/main.ff1ee215.chunk.js","sourcesContent":["import { Coordinate } from '../types/coordinate'\n\nexport interface IAppConfig {\n\tParcelPixelWidth: number;\n\tParcelPixelMinWidth: number;\n\tParcelPixelMaxWidth: number;\n\tParcelBlockWidth: number,\n\tParcelsPerQuery: number,\n\tOrigin: Coordinate;\n\tPanningStep: number;\n}\n\n// @NOTE(mzalla) To call `api.thegraph.com`, we can only fetch up to a maximum\n// of 1,000 items per query; by choosing a large parcel block size (30), we get\n// close to 1,000 parcels per block query without going over this limit;\nconst ParcelBlockWidth = 4\n\nconst AppConfig: IAppConfig = {\n\tParcelPixelWidth: 32,\n\tParcelPixelMinWidth: 14,\n\tParcelPixelMaxWidth: 80,\n\tParcelBlockWidth,\n\tParcelsPerQuery: ParcelBlockWidth * ParcelBlockWidth,\n\tOrigin: { x: 0, y: 0 },\n\tPanningStep: 3,\n}\n\nexport default AppConfig\n","import * as React from 'react'\n\nimport { Dimensions } from '../types/dimensions'\n\ntype UseScreenDimensionsHookResult = Dimensions\n\nconst useScreenDimensions = (): UseScreenDimensionsHookResult => {\n\n\tconst [screenDimensions, setScreenDimensions] = React.useState<Dimensions>({\n\t\twidth: window.innerWidth,\n\t\theight: window.innerHeight,\n\t})\n\n\tReact.useEffect(() => {\n\n\t\tfunction onWindowResize() {\n\t\t\tsetScreenDimensions({\n\t\t\t\twidth: window.innerWidth,\n\t\t\t\theight: window.innerHeight,\n\t\t\t})\n\t\t}\n\n\t\twindow.addEventListener(`resize`, onWindowResize)\n\n\t\treturn () => {\n\t\t\twindow.removeEventListener(`resize`, onWindowResize)\n\t\t}\n\n\t}, [\n\t\twindow.innerWidth,\n\t\twindow.innerHeight\n\t])\n\n\treturn screenDimensions\n\n}\n\nexport default useScreenDimensions\n","import * as React from 'react'\n\ninterface IUseMousewheelScalableOptions {\n\tdelta: number,\n\tminValue?: number,\n\tmaxValue?: number,\n}\n\nfunction clamp(\n\tvalue: number,\n\tmin: number = -Infinity,\n\tmax: number = Infinity): number\n{\n\treturn Math.max(\n\t\tmin || -Infinity,\n\t\tMath.min(value, max || Infinity)\n\t)\n}\n\nfunction useMousewheelScalable(\n\tinitialValue: number = 0,\n\toptions: IUseMousewheelScalableOptions = { delta: 1 })\n{\n\n\tconst [scalableValue, setScalableValue] = React.useState(initialValue)\n\n\tReact.useEffect(() => {\n\n\t\tfunction onMouseWheel(event: WheelEvent) {\n\n\t\t\tconst newValue = scalableValue + (event.deltaY < 0 ?\n\t\t\t\t-1 * options.delta :\n\t\t\t\toptions.delta)\n\n\t\t\tconst clampedValue = clamp(newValue, options.minValue, options.maxValue)\n\n\t\t\tsetScalableValue(clampedValue)\n\n\t\t}\n\n\t\twindow.addEventListener(`wheel`, onMouseWheel)\n\n\t\treturn () => {\n\t\t\twindow.removeEventListener(`wheel`, onMouseWheel)\n\t\t}\n\n\t}, [scalableValue, setScalableValue])\n\n\treturn scalableValue\n\n}\n\nexport default useMousewheelScalable\n","import * as React from 'react'\n\nimport { Coordinate } from '../types/coordinate'\n\nimport AppConfig from '../config/app-config'\n\nfunction useControlledCoordinate(coord: Coordinate = { x: 0, y: 0 }) {\n\n\tconst [coordinate, setCoordiante] = React.useState(coord)\n\n\tReact.useEffect(() => {\n\n\t\tfunction onKeydown(event: KeyboardEvent) {\n\t\t\tconst step = AppConfig.PanningStep;\n\t\t\tconst delta: Coordinate = { x: 0, y: 0 }\n\n\t\t\tswitch (event.key) {\n\t\t\t\tcase `ArrowUp`:\n\t\t\t\t\tdelta.y = step\n\t\t\t\t\tbreak;\n\t\t\t\tcase `ArrowDown`:\n\t\t\t\t\tdelta.y = -step\n\t\t\t\t\tbreak;\n\t\t\t\tcase `ArrowLeft`:\n\t\t\t\t\tdelta.x = -step\n\t\t\t\t\tbreak;\n\t\t\t\tcase `ArrowRight`:\n\t\t\t\t\tdelta.x = step\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tsetCoordiante({\n\t\t\t\tx: coordinate.x + delta.x,\n\t\t\t\ty: coordinate.y + delta.y,\n\t\t\t})\n\t\t}\n\n\t\twindow.addEventListener(`keydown`, onKeydown)\n\n\t\treturn () => {\n\t\t\twindow.removeEventListener(`keydown`, onKeydown)\n\t\t}\n\n\t}, [coordinate, setCoordiante])\n\n\treturn coordinate\n\n}\n\nexport default useControlledCoordinate\n","import { gql } from \"@apollo/client\";\n\n// See:\n//\n// https://thegraph.com/docs/developer/developer-faq#22-is-there-a-limit-\\\n//  to-how-many-objects-the-graph-can-return-per-query\n\nconst getBlockDataQuery = gql`\n\tquery GET_PARCEL_BLOCK(\n\t\t$first: Int,\n\t\t$xGte: BigInt\n\t\t$xLt: BigInt\n\t\t$yLte: BigInt\n\t\t$yGt: BigInt\n\t) {\n\t\tparcels(\n\t\t\tfirst: $first,\n\t\t\twhere: { x_gte: $xGte, x_lt: $xLt, y_lte: $yLte, y_gt: $yGt }\n\t\t) {\n\t\t\tid\n\t\t\t# tokenId\n\t\t\towner {\n\t\t\t\taddress\n\t\t\t}\n\t\t\tx\n\t\t\ty\n\t\t\t# data {\n\t\t\t# \tname\n\t\t\t# \tdescription\n\t\t\t# \tipns\n\t\t\t# }\n\t\t\testate {\n\t\t\t\t# id\n\t\t\t\t# tokenId\n\t\t\t\towner {\n\t\t\t\t\taddress\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n`\n\nexport default getBlockDataQuery\n","import {\n\tuseQuery,\n\tApolloError,\n} from '@apollo/client'\n\nimport { GET_PARCEL_BLOCK, GET_PARCEL_BLOCKVariables } from './__generated__/GET_PARCEL_BLOCK'\n\nimport { Coordinate } from \"../types/coordinate\";\n\nimport getBlockDataQuery from '../queries/getBlockData';\n\nimport AppConfig from '../config/app-config'\n\nexport type BlockDataQueryVariables = GET_PARCEL_BLOCKVariables\n\nexport type Block = GET_PARCEL_BLOCK\n\nexport type BlockDataResult = {\n\tdata?: Block,\n\tloading: boolean,\n\terror?: ApolloError,\n}\n\nexport type UseParcelBlockHookResult = {\n\tblockData?: GET_PARCEL_BLOCK;\n\tisBlockDataLoading: boolean;\n\tblockError?: ApolloError;\n}\n\nconst useParcelBlock = (blockCoords: Coordinate): UseParcelBlockHookResult => {\n\n\tconst variables: BlockDataQueryVariables = {\n\t\tfirst: AppConfig.ParcelsPerQuery,\n\t\txGte: blockCoords.x,\n\t\txLt: blockCoords.x + Math.sqrt(AppConfig.ParcelsPerQuery),\n\t\tyLte: blockCoords.y,\n\t\tyGt: blockCoords.y - Math.sqrt(AppConfig.ParcelsPerQuery),\n\t}\n\n\tconst { data: blockData, loading: isBlockDataLoading, error: blockError }: BlockDataResult =\n\t\tuseQuery(getBlockDataQuery, {\n\t\t\terrorPolicy: `all`,\n\t\t\tvariables,\n\t\t})\n\n\tif(blockError)\n\t{\n\t\tconsole.warn(`Failed to fetch block at (${blockCoords.x}, ${blockCoords.y}): ${JSON.stringify(blockError)}`)\n\t}\n\n\treturn { blockData, isBlockDataLoading, blockError }\n\n}\n\nexport default useParcelBlock\n","import { ApolloError } from '@apollo/client'\n\nimport { Parcel } from '../types/parcel'\nimport { Coordinate } from '../types/coordinate'\n\nimport { findParcel, getBlockCoordinate } from '../utils/parcel'\n\nimport useParcelBlock from './use-parcel-block'\n\nexport type UseParcelHookResult = {\n\tparcel?: Parcel;\n\tisBlockDataLoading: boolean;\n\tblockError?: ApolloError;\n}\n\nconst useParcel = ({ x, y }: Coordinate): UseParcelHookResult => {\n\n\tconst blockCoordinate = getBlockCoordinate(x, y)\n\n\tconst { blockData: block, isBlockDataLoading, blockError } = useParcelBlock(blockCoordinate)\n\n\tlet parcel: Parcel|undefined\n\n\tif(block)\n\t{\n\t\tparcel = findParcel(block, x, y)\n\t}\n\n\treturn { parcel, isBlockDataLoading, blockError }\n\n}\n\nexport default useParcel\n","import { Parcel } from '../types/parcel'\n\nimport { Color } from '../types/color'\nimport { Coordinate } from '../types/coordinate'\n\nimport { DAOContractAddress } from '../constants/DAOContractAddress'\n\nimport { Block } from '../hooks/use-parcel-block'\n\nimport AppConfig from '../config/app-config'\n\nfunction address(parcel: Parcel) {\n\treturn (parcel.estate ? parcel.estate : parcel).owner.address\n}\n\nfunction short(address: string) {\n\treturn `${address.slice(0, 5)}…${address.slice(address.length - 4)}`\n}\n\nfunction getBlockCoordinate(\n\tparcelX: number,\n\tparcelY: number): Coordinate\n{\n\treturn {\n\t\tx: parcelX - (parcelX % AppConfig.ParcelBlockWidth),\n\t\ty: parcelY - (parcelY % AppConfig.ParcelBlockWidth),\n\t}\n}\n\nfunction findParcel(\n\tblock: Block,\n\tx: number,\n\ty: number): Parcel|undefined\n{\n\treturn block?.parcels.find(\n\t\tp => parseInt(p.x) === x && parseInt(p.y) === y\n\t)\n}\n\nfunction getParcelSaturation(\n\tparcel: Parcel,\n\tselectedParcel: Parcel|null): number\n{\n\tif(\n\t\tselectedParcel &&\n\t\thasSameOwner(parcel, selectedParcel) === false\n\t)\n\t{\n\t\treturn 0.05\n\t}\n\n\treturn 1.00\n}\n\nfunction getParcelColor(\n\tparcel: Parcel,\n\tselectedParcel: Parcel|null,\n\taddress: string): Color\n{\n\tif (address === DAOContractAddress) {\n\t\treturn [0, 0, 0, 255]\n\t}\n\n\t//    0            12           24           36\n\t// 0x 9a6ebe7e2a77 22f8200d0ffb 63a1f6406a0d 7dce\n\n\taddress = address.slice(2)\n\n\tlet r = parseInt(address.slice(0, 12), 16) % 256\n\tlet g = parseInt(address.slice(12, 24), 16) % 256\n\tlet b = parseInt(address.slice(24, 36), 16) % 256\n\tlet a = 255\n\n\treturn [r, g, b, a]\n}\n\nfunction hasSameOwner(\n\tparcel: Parcel,\n\tselectedParcel: Parcel): boolean\n{\n\n\tif (selectedParcel.estate || parcel.estate)\n\t{\n\t\tif(selectedParcel.estate && parcel.estate)\n\t\t{\n\t\t\tif(selectedParcel.estate.owner.address === parcel.estate.owner.address)\n\t\t\t{\n\t\t\t\treturn true\n\t\t\t}\n\t\t}\n\t\telse if(selectedParcel.estate)\n\t\t{\n\t\t\tif(selectedParcel.estate.owner.address === parcel.owner.address)\n\t\t\t{\n\t\t\t\treturn true\n\t\t\t}\n\t\t}\n\t\telse if(selectedParcel.owner.address === parcel.estate?.owner.address)\n\t\t{\n\t\t\treturn true\n\t\t}\n\t} else if (parcel.owner.address === selectedParcel.owner.address) {\n\t\treturn true\n\t}\n\n\treturn false\n\n}\n\nexport {\n\taddress,\n\tshort,\n\tgetParcelSaturation,\n\tgetParcelColor,\n\thasSameOwner,\n\tgetBlockCoordinate,\n\tfindParcel,\n}\n","import * as React from 'react'\n\nimport { areEqual } from 'react-window'\n\nimport { Parcel } from '../../types/parcel'\n\nimport useParcel from '../../hooks/use-parcel'\n\nimport {\n\taddress,\n\tgetParcelColor,\n\tgetParcelSaturation\n} from '../../utils/parcel'\n\ninterface IParcelGridCellItemData {\n\txMin: number,\n\tyMax: number,\n\tsize: number,\n\tselectedParcel: Parcel|null,\n\tsetSelectedParcel: Function\n}\n\ninterface IParcelGridCellProps extends React.PropsWithChildren<React.Attributes> {\n\tdata: IParcelGridCellItemData;\n\tcolumnIndex: number,\n\trowIndex: number,\n\tstyle: React.CSSProperties,\n}\n\nconst ParcelGridCellDefaultStyles = {\n\tpadding: `4px`,\n\tfontSize: '9px',\n\tfilter: `grayscale(0.0)`,\n\ttransition: `filter 0.35s ease-in-out`,\n}\n\nconst ParcelGridCell = React.memo(({\n\tdata,\n\tcolumnIndex,\n\trowIndex,\n\tstyle,\n}: IParcelGridCellProps) => {\n\tconst { parcel, isBlockDataLoading, blockError } =\n\t\tuseParcel({ x: columnIndex + data.xMin, y: data.yMax - rowIndex })\n\n\tif(parcel)\n\t{\n\t\tconst addr = address(parcel)\n\n\t\tconst backgroundColor = getParcelColor(\n\t\t\tparcel,\n\t\t\tdata.selectedParcel,\n\t\t\taddr)\n\n\t\tconst parcelSaturation = getParcelSaturation(parcel, data.selectedParcel)\n\n\t\tconst grayscaleFilterValue = `${1.0 - parcelSaturation}`\n\n\t\treturn (\n\t\t\t<div\n\t\t\t\tonMouseEnter={() => data.setSelectedParcel(parcel)}\n\t\t\t\tstyle={{\n\t\t\t\t\tbackgroundColor: `rgba(${backgroundColor.join(',')})`,\n\t\t\t\t\t...ParcelGridCellDefaultStyles,\n\t\t\t\t\tfilter: `grayscale(${grayscaleFilterValue})`,\n\t\t\t\t\t...style,\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{/*\n\t\t\t\t{\n\t\t\t\t\tdata.size >= MinimumSizeToShowDetails &&\n\t\t\t\t\taddr !== DAOContractAddress && (\n\t\t\t\t\t\t`${parcel.x},${parcel.y}`\n\t\t\t\t\t\t// <p>\n\t\t\t\t\t\t// \t<a\n\t\t\t\t\t\t// \t\tclassName=\"hyperlink\"\n\t\t\t\t\t\t// \t\thref={`https://etherscan.io/address/${addr}`}\n\t\t\t\t\t\t// \t\trel=\"noopener noreferrer nofollow\"\n\t\t\t\t\t\t// \t\ttarget=\"_blank\"\n\t\t\t\t\t\t// \t>\n\t\t\t\t\t\t// \t\t{shortAddr}\n\t\t\t\t\t\t// \t</a>\n\t\t\t\t\t\t// </p>\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t\t*/}\n\t\t\t</div>\n\t\t)\n\t}\n\n\tif (isBlockDataLoading || blockError || !parcel) {\n\t\treturn (\n\t\t\t<div\n\t\t\t\tstyle={{\n\t\t\t\t\topacity: isBlockDataLoading ? 0.4 : 0.8,\n\t\t\t\t\tbackgroundColor: blockError ? 'red' : 'grey',\n\t\t\t\t\t...ParcelGridCellDefaultStyles,\n\t\t\t\t\t...style\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<p>\n\t\t\t\t\t({columnIndex + data.xMin},{data.yMax - rowIndex})\n\t\t\t\t\t{ isBlockDataLoading && `Loading…` }\n\t\t\t\t\t{ blockError && `Error!` }\n\t\t\t\t</p>\n\n\t\t\t</div>\n\t\t)\n\t}\n\n\tconsole.warn(`This should be impossible!`)\n\n\treturn null\n\n\n}, areEqual)\n\nexport { ParcelGridCell }\n","export const DAOContractAddress = `0x9a6ebe7e2a7722f8200d0ffb63a1f6406a0d7dce`\n\n// const ETH_DEAD_ADDRESS = `0x000000000000000000000000000000000000dEaD`\n","import React from 'react';\n\nimport memoize from 'memoize-one';\n\nimport { css } from '@emotion/css';\n\nimport {FixedSizeGrid as Grid} from 'react-window'\n\nimport { Coordinate } from '../../types/coordinate'\nimport { Parcel } from '../../types/parcel'\nimport { Dimensions } from '../../types/dimensions';\n\nimport { ParcelGridCell } from '../ParcelGridCell/ParcelGridCell'\n\ninterface IParcelGridProps extends React.PropsWithChildren<React.Attributes> {\n\tparcelBounds: Coordinate[];\n\tparcelCellSize: number;\n\tscreenDimensions: Dimensions;\n\tselectedParcel: Parcel|null;\n\tsetSelectedParcel: Function;\n}\n\nconst buildItemData = memoize(\n\t(size: number, xMin: number, yMax: number, selectedParcel, setSelectedParcel) =>\n\t\t({ size, xMin, yMax, selectedParcel, setSelectedParcel })\n)\n\nfunction ParcelGrid(\n\t{ parcelBounds, parcelCellSize, screenDimensions, selectedParcel, setSelectedParcel }: IParcelGridProps)\n{\n\n\tconst parcelBoundsPadding = 0\n\n\tconst xMin = parcelBounds[0].x - parcelBoundsPadding\n\n\tconst yMax = parcelBounds[0].y + parcelBoundsPadding\n\n\tconst columnCount = Math.ceil(screenDimensions.width / parcelCellSize)\n\tconst rowCount = Math.ceil(screenDimensions.height / parcelCellSize)\n\n\tconst itemData = buildItemData(parcelCellSize, xMin, yMax, selectedParcel, setSelectedParcel)\n\n\treturn (\n\t\t<div onMouseLeave={() => setSelectedParcel(null)}>\n\t\t\t<Grid\n\t\t\t\tclassName={\n\t\t\t\t\tcss({\n\t\t\t\t\t\twidth: `${screenDimensions.width}px !important`,\n\t\t\t\t\t\theight: `${screenDimensions.height}px !important`,\n\t\t\t\t\t\toverflow: `hidden !important`,\n\t\t\t\t\t\t'&:hover': {\n\t\t\t\t\t\t\tcursor: `pointer`\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\twidth={screenDimensions.width}\n\t\t\t\theight={screenDimensions.height}\n\t\t\t\tcolumnWidth={parcelCellSize}\n\t\t\t\trowHeight={parcelCellSize}\n\t\t\t\tcolumnCount={columnCount}\n\t\t\t\trowCount={rowCount}\n\t\t\t\titemKey={data => `(${data.columnIndex},${data.rowIndex})`}\n\t\t\t\titemData={itemData}\n\t\t\t>\n\t\t\t\t{ParcelGridCell}\n\t\t\t</Grid>\n\n\t\t</div>\n\n\t)\n}\n\nexport default ParcelGrid\n","import React from 'react'\n\nimport { css } from '@emotion/css'\n\nimport { Parcel } from '../../types/parcel'\nimport { Coordinate } from '../../types/coordinate'\n\nimport AppConfig from '../../config/app-config'\n\nimport useScreenDimensions from '../../hooks/use-screen-dimensions'\nimport useMousewheelScalable from '../../hooks/use-mousewheel-scalable'\nimport useControlledCoordinate from '../../hooks/use-controlled-coordinate'\n\nimport ParcelGrid from '../ParcelGrid/ParcelGrid'\n\nimport './App.css'\n\nfunction App() {\n\tconst screenDimensions = useScreenDimensions()\n\tconst parcelCellSize = useMousewheelScalable(AppConfig.ParcelPixelWidth, {\n\t\tdelta: 4,\n\t\tminValue: AppConfig.ParcelPixelMinWidth,\n\t\tmaxValue: AppConfig.ParcelPixelMaxWidth,\n\t})\n\tconst origin = useControlledCoordinate(AppConfig.Origin)\n\n\tconst parcelBounds: Coordinate[] = [\n\t\torigin,\n\t\t{\n\t\t\tx: origin.x + Math.sqrt(AppConfig.ParcelsPerQuery),\n\t\t\ty: origin.y - Math.sqrt(AppConfig.ParcelsPerQuery),\n\t\t},\n\t]\n\n\tconst [selectedParcel, setSelectedParcel] = React.useState<Parcel|null>(null)\n\n\treturn (\n\t\t<div\n\t\t\tclassName={css({\n\t\t\t\tcolor: `lightgray`,\n\t\t\t\tbackgroundColor: `white`,\n\t\t\t\twidth: `${screenDimensions.width}px`,\n\t\t\t\theight: `${screenDimensions.height}px`,\n\t\t\t\toverflow: `hidden`,\n\t\t\t})}\n\t\t>\n\t\t\t<ParcelGrid\n\t\t\t\tparcelBounds={parcelBounds}\n\t\t\t\tparcelCellSize={parcelCellSize}\n\t\t\t\tscreenDimensions={screenDimensions}\n\t\t\t\tselectedParcel={selectedParcel}\n\t\t\t\tsetSelectedParcel={setSelectedParcel}\n\t\t\t></ParcelGrid>\n\t\t</div>\n\t)\n}\n\nexport default App\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport App from './components/App/App'\nimport reportWebVitals from './reportWebVitals'\n\nimport localForage from 'localforage'\n\nimport {\n\tpersistCache,\n\tLocalForageWrapper\n} from 'apollo3-cache-persist'\n\nimport {\n\tApolloClient,\n\tInMemoryCache,\n\tApolloProvider,\n} from '@apollo/client'\n\nasync function getClient() {\n\tconst cache = new InMemoryCache({\n\t\ttypePolicies: {\n\t\t\tParcel: {\n\t\t\t\tkeyFields: ['x', 'y']\n\t\t\t},\n\t\t}\n\t})\n\n\tlocalForage.config({\n\t\tname: 'metestates',\n\t\tstoreName: 'keyvaluepairs',\n\t\tdescription: 'Local storage for the Metestates web app.'\n\t})\n\n\t// await persistCache({\n\t// \tcache: cache,\n\t// \tstorage: new LocalForageWrapper(localForage),\n\t// })\n\n\tconst client = new ApolloClient({\n\t\t// https://api.decentraland.org/v1/tiles\n\t\turi: `https://api.thegraph.com/subgraphs/name/decentraland/marketplace`,\n\t\tcache: cache,\n\t\t// name: `Metestates`,\n\t\t// version: `0.1.0`,\n\t})\n\n\treturn client\n}\n\nasync function init() {\n\n\tconst client = await getClient()\n\n\tReactDOM.render(\n\n\t\t(\n\t\t\t<React.StrictMode>\n\t\t\t\t<ApolloProvider client={client}>\n\t\t\t\t\t<App />\n\t\t\t\t</ApolloProvider>\n\t\t\t</React.StrictMode>\n\t\t),\n\n\t\tdocument.getElementById('root')\n\n\t)\n\n\t// If you want to start measuring performance in your app, pass a function\n\t// to log results (for example: reportWebVitals(console.log))\n\t// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n\treportWebVitals()\n\n}\n\ninit()\n"],"sourceRoot":""}